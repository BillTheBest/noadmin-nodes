<!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<!--Edit Template for LDAP write node -->
<script type="text/x-red" data-template-name="ldap-write out">
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-globe"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name"><br />
        <label for="node-input-basedn"><i class="fa fa-tag"></i> Base DN</label>
        <input type="text" id="node-input-basedn" placeholder="Base DN"><br />
        <label for="node-input-objectclass"><i class="fa fa-tag"></i> objectClass</label>
        <input type="text" id="node-input-objectclass" placeholder="objectClass"><br />
        <label for="node-input-operation"><i class="fa fa-tag"></i> Operation</label>
        <select name="operation" id="node-input-operation">
          <option value="add" selected>Add</option>
          <option value="modify">Modify</option>
          <option value="remove">Remove</option>
        </select>
    </div>
</script>

<!--Help Template for LDAP write node -->
<script type="text/x-red" data-help-name="ldap-write out">
<p>The LDAP write node modifies the provided LDAP server configuration. It supports the following operations:</p>
<ul>
  <li>Adding an LDAP Record</li>
  <li>Removing an LDAP Record</li>
  <li>Modifying an LDAP Record based on changed attributes </li>
</ul>
<p>The node takes in the following parameters:</p>
<ul>
  <li>Server: The URI of the LDAP server</li>
  <li>Port: The port that the LDAP server listens on</li>
  <li>Bind DN: The DN to be used to connect to the server</li>
  <li>Password: The password to be used to connect to the server</li>
  <li>Name: The name to be used for the node</li>
  <li>Base DN: The Base DN to be used for LDAP operations</li>
  <li>objectClass: A Comma separated list which specify what type of records will be acted upon</li>
  <li>Operation: Specifies the operation that would be performed. Can be one of <i>Add</i>, <i>Modify</i>, <i>Remove</i></li>
</ul>
<p>In case the LDAP operation succeeds, the incoming <b>msg</b> object is passed on to the subsequent node. In case of an error, the message is not passed to the subsequent node, and an error is raised. An exception to this, is the case in adding an LDAP record if the record already exists. In this case, an attempt to modify the record is made, based on the provided properties.  </p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('ldap-write out',{
        category: 'storage-output',      
        defaults: {             
            name: {value:""},   
            server: {type: "ldap", required:true},
            operation: {value: "", required:true},
            basedn: {value: "", required: true},
            objectclass: {value: "", required: true}
        },
        inputs:1,               
        outputs:1,              
        color: "rgb(218, 196, 180)",
        icon: "watch.png",    
        label: function() {
            return this.name||this.topic||"LDAP Write Node";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>
